<header
	class='fixed top-0 left-0 right-0 z-[65] w-screen max-w-[100vw] overflow-x-clip border-b border-slate-200/70 bg-white/80 shadow-md backdrop-blur-lg transition-all duration-300'
	id='site-header'
>
	<div
		id='header-inner'
		class='mx-auto flex h-20 w-full max-w-[1200px] min-w-0 items-center gap-1 px-3 transition-all duration-300 md:px-8'
	>
		<!-- Logo -->
		<a href='/' class='min-w-0 shrink transition-transform duration-300 hover:scale-105'>
			<img src='/logo-horizontal.svg' alt='DAK Burger' class='h-12 w-auto max-w-[40vw] md:h-14 md:max-w-none' />
		</a>

		<!-- Desktop nav -->
		<nav class='hidden flex-1 items-center justify-center gap-7 md:flex' id='desktop-nav'>
			<a
				href='/'
				class='group relative px-1 py-2 text-sm font-semibold uppercase tracking-wide text-slate-800 transition-colors hover:text-primary'
			>
				Inicio
				<span class='absolute -bottom-0.5 left-0 h-0.5 w-0 bg-primary transition-all duration-300 group-hover:w-full'
				></span>
			</a>
			<a
				href='/carta'
				class='group relative px-1 py-2 text-sm font-semibold uppercase tracking-wide text-slate-800 transition-colors hover:text-primary'
			>
				Menu
				<span class='absolute -bottom-0.5 left-0 h-0.5 w-0 bg-primary transition-all duration-300 group-hover:w-full'
				></span>
			</a>
			<a
				href='/conocenos'
				class='group relative px-1 py-2 text-sm font-semibold uppercase tracking-wide text-slate-800 transition-colors hover:text-primary'
			>
				Conocenos
				<span class='absolute -bottom-0.5 left-0 h-0.5 w-0 bg-primary transition-all duration-300 group-hover:w-full'
				></span>
			</a>
		</nav>

		<!-- CTAs — always visible including mobile -->
		<div class='ml-auto flex shrink-0 items-center gap-2'>
			<a
				href='https://dakburgerlacalademijas.order.app.hd.digital/menus'
				target='_blank'
				rel='noopener noreferrer'
				class='inline-flex h-10 items-center justify-center whitespace-nowrap rounded-full bg-accent px-4 text-xs font-bold uppercase tracking-wide text-white shadow-none transition-colors hover:bg-accent-600 md:min-w-[170px] md:px-5 md:text-xs md:shadow-lg'
			>
				Pide ahora
			</a>
		</div>

		<div class='hidden shrink-0 md:flex'>
			<a
				href='/reserva'
				class='inline-flex h-10 items-center justify-center whitespace-nowrap rounded-full bg-primary px-4 text-xs font-bold uppercase tracking-wide text-white shadow-none transition-colors hover:bg-primary-600 md:min-w-[170px] md:px-5 md:shadow-lg'
			>
				Reservar
			</a>
		</div>

		<!-- Mobile menu toggle -->
		<button
			id='menu-btn'
			class='relative ml-0.5 flex h-10 w-10 shrink-0 items-center justify-center rounded-full border border-slate-200 bg-slate-100/90 backdrop-blur-sm transition-all duration-300 md:hidden'
			aria-label='Abrir menu'
			aria-expanded='false'
			aria-controls='mobile-menu'
		>
			<img id='menu-astronaut' src='/astronaut.svg' alt='' class='h-6 w-6' />
		</button>
	</div>
</header>

<!-- Mobile menu overlay (above header) -->
<div
	id='mobile-menu'
	class='fixed inset-0 z-[90] flex flex-col bg-gradient-to-b from-primary/95 via-primary-700/90 to-dark/95 backdrop-blur-lg opacity-0 pointer-events-none transition-opacity duration-300 md:hidden'
>
	<div class='flex h-20 items-center justify-end px-5'>
		<button
			id='mobile-menu-close'
			class='flex h-10 w-10 items-center justify-center rounded-full border border-white/40 bg-white/10 text-white'
			aria-label='Cerrar menu'
		>
			<svg class='h-5 w-5' fill='none' viewBox='0 0 24 24' stroke='currentColor' stroke-width='2.5' aria-hidden='true'>
				<path stroke-linecap='round' stroke-linejoin='round' d='M6 18L18 6M6 6l12 12'></path>
			</svg>
		</button>
	</div>

	<nav class='flex flex-1 flex-col items-center justify-center gap-5 px-8 pb-10'>
		<a href='/' class='menu-anim-item delay-1 font-heading text-4xl text-white transition-colors hover:text-accent'
			>Inicio</a
		>
		<a href='/carta' class='menu-anim-item delay-2 font-heading text-4xl text-white transition-colors hover:text-accent'
			>Menu</a
		>
		<a
			href='/conocenos'
			class='menu-anim-item delay-3 font-heading text-4xl text-white transition-colors hover:text-accent'>Conocenos</a
		>
		<a
			href='/reserva'
			class='menu-anim-item delay-4 font-heading text-4xl text-white transition-colors hover:text-accent'>Reserva</a
		>

		<div class='menu-anim-item delay-5 my-1 h-px w-20 bg-white/25'></div>

		<div class='menu-anim-item delay-6 flex w-full max-w-xs flex-col items-stretch gap-3'>
			<a
				href='https://dakburgerlacalademijas.order.app.hd.digital/menus'
				target='_blank'
				rel='noopener noreferrer'
				class='btn-accent justify-center w-full'
			>
				Pedir a domicilio
			</a>
			<a href='/reserva' class='btn-primary justify-center w-full'> Reservar mesa </a>
		</div>

		<div class='menu-anim-item delay-7 mt-2 flex flex-col items-center gap-1 text-center'>
			<p class='text-xs font-medium uppercase tracking-widest text-white/35'>
				Av. de Mare Nostrum 8 · La Cala de Mijas
			</p>
			<a href='tel:+34951068777' class='text-xs text-white/45 transition-colors hover:text-white/80'>951 06 87 77</a>
		</div>
	</nav>
</div>

<style>
	@keyframes _menuIn {
		from {
			opacity: 0;
			transform: translateY(16px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}
	.menu-anim-item {
		opacity: 0;
		transform: translateY(16px);
	}
	.menu-anim-item.delay-1 {
		--delay: 0.07s;
	}
	.menu-anim-item.delay-2 {
		--delay: 0.14s;
	}
	.menu-anim-item.delay-3 {
		--delay: 0.21s;
	}
	.menu-anim-item.delay-4 {
		--delay: 0.28s;
	}
	.menu-anim-item.delay-5 {
		--delay: 0.35s;
	}
	.menu-anim-item.delay-6 {
		--delay: 0.42s;
	}
	.menu-anim-item.delay-7 {
		--delay: 0.49s;
	}
	#mobile-menu.menu-open .menu-anim-item {
		animation: _menuIn 0.42s ease forwards;
		animation-delay: var(--delay, 0s);
	}
</style>

<script>
	const menuBtn = document.getElementById('menu-btn') as HTMLButtonElement | null
	const menuCloseBtn = document.getElementById('mobile-menu-close') as HTMLButtonElement | null
	const mobileMenu = document.getElementById('mobile-menu')
	const menuAstronaut = document.getElementById('menu-astronaut')
	const header = document.getElementById('site-header')
	const headerInner = document.getElementById('header-inner')
	let isOpen = false

	function openMenu() {
		isOpen = true
		mobileMenu?.classList.add('menu-open')
		mobileMenu?.classList.remove('opacity-0', 'pointer-events-none')
		document.body.style.overflow = 'hidden'
		menuBtn?.setAttribute('aria-expanded', 'true')
		menuAstronaut?.classList.add('opacity-0')
	}

	function closeMenu() {
		isOpen = false
		mobileMenu?.classList.remove('menu-open')
		mobileMenu?.classList.add('opacity-0', 'pointer-events-none')
		document.body.style.overflow = ''
		menuBtn?.setAttribute('aria-expanded', 'false')
		menuAstronaut?.classList.remove('opacity-0')
	}

	menuBtn?.addEventListener('click', () => (isOpen ? closeMenu() : openMenu()))
	menuCloseBtn?.addEventListener('click', closeMenu)
	mobileMenu?.querySelectorAll('a').forEach((l) => l.addEventListener('click', closeMenu))

	function updateHeader() {
		if (window.scrollY > 20) {
			header?.classList.add('bg-white/90', 'border-slate-200/80')
			header?.classList.remove('bg-white/80', 'border-slate-200/70')
			headerInner?.classList.remove('h-20')
			headerInner?.classList.add('h-[4.5rem]')
		} else {
			header?.classList.add('bg-white/80', 'border-slate-200/70')
			header?.classList.remove('bg-white/90', 'border-slate-200/80')
			headerInner?.classList.remove('h-[4.5rem]')
			headerInner?.classList.add('h-20')
		}
	}
	updateHeader()
	window.addEventListener('scroll', updateHeader, { passive: true })
</script>
